<?php/*///////////////////////////////////////////////////////////////////////Part of the code from the book Building Findable Websites: Web Standards, SEO, and Beyondby Aarron Walter (aarron@buildingfindablewebsites.com)http://buildingfindablewebsites.comDistrbuted under Creative Commons licensehttp://creativecommons.org/licenses/by-sa/3.0/us////////////////////////////////////////////////////////////////////////*/function storeAddress(){		// Validation	if(!$_GET['sm_email']){ return "No email address provided"; } 	if(!preg_match("/^[_a-z0-9-]+(\.[_a-z0-9-]+)*@[a-z0-9-]+(\.[a-z0-9-]+)*$/i", $_GET['sm_email'])) {		return "Email address is invalid"; 	}	$smf_data  = '* Name : '.$_GET['sm_name'];	$smf_data .= ' Email : '.$_GET['sm_email'].' , '. PHP_EOL;	/*	$smf_data = array(		 array($_POST['name']),		 array($_POST['email'] )		);		*/	$file = "sm_subscribers_list.php"; 		$fp = fopen($file, "a"); 	fwrite($fp, $smf_data);	fclose($fp); 		require_once('MCAPI.class.php');	// grab an API Key from http://admin.mailchimp.com/account/api/	$sm_api_key = get_option('ssm_mailchimp_api_key');	$api = new MCAPI($sm_api_key);	$merge_vars = Array(         'EMAIL' => $_GET['sm_email'],        'FNAME' => $_GET['sm_name']    );		// grab your List's Unique Id by going to http://admin.mailchimp.com/lists/	// Click the "settings" link for the list - the Unique Id is at the bottom of that page. 	$list_id = get_option('ssm_mailchimp_list_id');	if($api->listSubscribe($list_id, $_GET['sm_email'],$merge_vars, '') === true) {		// It worked!			return 'Success! Check your email to confirm subscription.'.$smf_data;		 	}else{		// An error ocurred, return error message			return 'Error: ' . $api->errorMessage;	}}// If being called via ajax, autorun the functionif($_GET['ajax']){ echo storeAddress(); }?>